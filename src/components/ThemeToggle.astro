---
import { SITE } from "@config";
---

{
  SITE.lightAndDarkMode && (
    <button id="theme-btn" aria-label="theme-toggle">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="icon-moon"
        aria-hidden="true"
        ><path
          d="M19.5 13.14a7.5 7.5 0 0 1-7.79 7.79 7.34 7.34 0 0 1-3.21-.79 7.5 7.5 0 0 1-7.79-7.79 7.34 7.34 0 0 1 .79-3.21A7.5 7.5 0 0 1 9.3 1.5a7.34 7.34 0 0 1 3.21.79A7.5 7.5 0 0 1 19.5 13.14Z"
        ></path></svg
      >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="icon-sun"
        aria-hidden="true"
        ><path
          d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364-.707-.707M6.343 17.657l-.707-.707m12.728 0-.707.707M6.343 6.343l-.707.707M12 6a6 6 0 1 0 0 12 6 6 0 0 0 0-12Z"
        ></path></svg
      >
    </button>
  )
}

<script is:inline>
  const themeBtn = document.getElementById("theme-btn");
  const getTheme = () => {
    if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
      return localStorage.getItem("theme");
    }
    if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
      return "dark";
    }
    return "light";
  };
  const theme = getTheme();
  const root = document.documentElement;
  if (theme === "light") {
    root.classList.remove("dark");
  } else {
    root.classList.add("dark");
  }
  localStorage.setItem("theme", theme);

  const toggleTheme = () => {
    root.classList.toggle("dark");
    let theme = "light";
    if (root.classList.contains("dark")) {
      theme = "dark";
    }
    localStorage.setItem("theme", theme);
  };
  themeBtn.addEventListener("click", toggleTheme);
</script>
